---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

# Adrian Lim June 2015
## Loading and preprocessing the data
Uncompress the activity.zip file and read it
```{r}
filename <- unzip("activity.zip")
df <- read.csv("activity.csv",header = TRUE,na.strings = "NA",sep = ",")
str(df)
```
Convert the date string into proper Date format
```{r}
library("dplyr")
df <- tbl_df(df)
df <- mutate(df,date = as.Date(date, format = '%Y-%m-%d'))
str(df)
```
## What is mean total number of steps taken per day?
Filter out the rows with missing values (denoted by 'NA')  
```{r}
num <- nrow(df)
dfnoNA <- filter(df,steps != "NA")
num1 <- nrow(dfnoNA)
numNA <- num - num1
```
Number of rows without missing values(NA) is `r num1`.  
Number of rows with missing values(NA) is `r numNA`  
  
1) Group data by each day then sum up the number of steps for that day.  
2) Plot a histogram of the Total Steps.    
```{r}
dfnoNA <- group_by(dfnoNA,date) 
dfh <- summarise(dfnoNA,TotalSteps = sum(steps))
hist(dfh$TotalSteps,main="Histogram of Total Steps",breaks=20)
```
  
3) Calculate the mean and median of the total number of steps taken per day
```{r}
mean <- summarise(dfh,mean(TotalSteps))
median <- summarise(dfh,median(TotalSteps))
```
Mean is `r mean`  
Median is `r median`

## What is the average daily activity pattern?
1) Make a time series plot of the 5 minute interval(x axis) and the average  
number of steps taken, averaged across all days(y axis)
```{r}
dfnoNA <- tapply(dfnoNA$steps,dfnoNA$interval,mean)
plot(y=dfnoNA,x=names(dfnoNA),type='l',main="Average Number of Steps by Interval",xlab="Interval",ylab="Average Number of Steps")
```
  
2) The 5 minute interval containing the maximum number of steps is  
```{r}
dfnoNA[dfnoNA == max(dfnoNA)]
```
## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
